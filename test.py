import streamlit as st
import plotly.express as px

st.set_page_config(page_title="학교 생활 밸런스 게임", page_icon="🎀", layout="centered")

st.title("🎀 학교 생활 밸런스 게임 🎀")
st.write("당신의 선택으로 알아보는 과장되고 웃긴 학교 생활 유형 테스트 ✨")

# 학교 생활 유형과 설명
descriptions = {
    "모범생 3000 ✏️": "언제 어디서든 교과서와 함께하는 당신! 수업 시간에 질문하면 늘 대답 준비 완료. 선생님의 보물 1호이자 친구들의 비공식 과외쌤. 하지만 가끔 너무 똑똑해서 '공부 로봇' 소리 듣는 경우도 있음. 친구들이 시험 전날 당신만 찾는 건 이미 전설.",
    "급식 요정 🍱": "학교 생활의 진정한 행복을 급식에서 찾는 당신! 메뉴판만 봐도 하루 컨디션이 달라지고, 디저트가 나오면 그날은 인생의 절정. 급식 줄 서는 것도 전략적으로 계산하고, 원하는 메뉴가 나오면 누구보다 빠르게 포착하는 능력자.",
    "복도 아이돌 🎤": "쉬는 시간이 되면 복도는 곧 당신의 무대! 노래, 춤, 애드립까지 풀세트로 장착해 주변을 즐겁게 만듦. 몰래 찍힌 영상이 단톡방에 퍼지는 건 일상. 스타병이 아니라 진짜 스타일지도? 덕분에 반 친구들 분위기는 늘 업!",
    "숨은 게이머 🎮": "현실에서는 조용한 학생이지만, 온라인 세계에서는 이미 프로급! 게임 닉네임으로 불리면 더 친근할 정도. 시험 기간에도 '오늘 밤 한 판만?'이 새벽까지 이어지는 건 비밀. 전략 짜는 능력 하나만큼은 현실에서도 빛을 발함.",
    "잠꾸러기 고라니 😴": "아침마다 교실에 들어오면 눈이 반쯤 감긴 상태. 쉬는 시간은 충전 타임이고 점심 먹고 나면 졸음 모드 ON. 하지만 시험 전날에도 잠을 포기 못 하는 ‘수면 최강자’. 친구들이 졸고 있는 당신을 깨우는 건 거의 불가능.",
    "지식 폭격기 📚": "잡학다식의 끝판왕! 역사, 과학, 인터넷 밈까지 모르는 게 없는 당신. 얘기하다 보면 다들 '이걸 왜 알아?' 하면서도 묘하게 재밌어서 듣게 됨. 위키피디아보다 신뢰도 높은 인간 백과사전, 다만 수업 시간에 자꾸 TMI 폭탄 투하.",
    "체육관 파이터 🥊": "체육 시간만 되면 눈빛이 달라지는 전투력 만렙! 달리기든 축구든 배드민턴이든 못 하는 게 없음. 체육대회 MVP는 거의 전속 계약 수준. 하지만 경쟁심이 지나쳐서 가끔 친구들이 '너 진짜 국가대표 노리는 거 아냐?'라며 농담을 던짐.",
    "환경 지키미 🌱": "작은 쓰레기도 못 지나치고 재활용 분리수거에 진심인 당신. 친구들이 '환경부 장관님'이라 부를 정도. 나무 심기 행사 있으면 바로 1등 지원! 교내 생태계의 진정한 수호자, 사실은 지구의 숨은 히어로.",
    "급발진 인싸 🚀": "분위기만 뜨면 바로 텐션 최대로 치솟는 당신! 모르는 애랑도 순식간에 친해지고, 단톡방에선 이모티콘 폭격으로 활약. 종종 과몰입해서 주위가 당황할 때도 있지만, 당신 덕분에 반 분위기는 언제나 웃음 가득."
}

# 점수 초기화
scores = {k: 0 for k in descriptions.keys()}

# 질문과 선택지
questions = [
    {
        "question": "시험 전날 나는?",
        "choices": {
            "밤새 벼락치기 📖": {"모범생 3000 ✏️": 2, "지식 폭격기 📚": 1},
            "그냥 잔다 🛌": {"잠꾸러기 고라니 😴": 2, "숨은 게이머 🎮": 1},
        }
    },
    {
        "question": "쉬는 시간에 나는?",
        "choices": {
            "자리에서 책 본다 📚": {"모범생 3000 ✏️": 1, "지식 폭격기 📚": 2},
            "복도에서 댄스 🎶": {"복도 아이돌 🎤": 2, "급발진 인싸 🚀": 1},
        }
    },
    {
        "question": "점심시간 나는?",
        "choices": {
            "급식 줄 맨 앞 🏃‍♀️": {"급식 요정 🍱": 2, "급발진 인싸 🚀": 1},
            "친구랑 도시락 나눠먹기 🍱": {"환경 지키미 🌱": 1, "잠꾸러기 고라니 😴": 1, "급식 요정 🍱": 1},
        }
    },
    {
        "question": "체육대회가 다가오면?",
        "choices": {
            "전력 질주 준비! 🏃‍♀️": {"체육관 파이터 🥊": 2, "급발진 인싸 🚀": 1},
            "그늘에서 음료 마시기 🥤": {"잠꾸러기 고라니 😴": 1, "급식 요정 🍱": 1},
        }
    },
    {
        "question": "학교 청소 시간 나는?",
        "choices": {
            "환경 지킴이 모드 🌱": {"환경 지키미 🌱": 2, "모범생 3000 ✏️": 1},
            "청소하다 수다 삼매경 💬": {"급발진 인싸 🚀": 2, "복도 아이돌 🎤": 1},
        }
    },
    {
        "question": "방과 후 나는?",
        "choices": {
            "학원 직행 ✏️": {"모범생 3000 ✏️": 2, "지식 폭격기 📚": 1},
            "PC방 직행 🎮": {"숨은 게이머 🎮": 2, "잠꾸러기 고라니 😴": 1},
        }
    },
    {
        "question": "교실 단톡방에서 나는?",
        "choices": {
            "자료 공유 요정 📂": {"모범생 3000 ✏️": 1, "지식 폭격기 📚": 2},
            "이모티콘 폭격기 😂": {"급발진 인싸 🚀": 2, "복도 아이돌 🎤": 1},
        }
    },
]

# 사용자 선택 반영
for q in questions:
    st.subheader(q["question"])
    choice = st.radio("선택하세요:", list(q["choices"].keys()), key=q["question"])
    for k, v in q["choices"][choice].items():
        scores[k] += v

# 최종 결과
st.markdown("---")
st.header("🎉 결과 발표 🎉")

final_type = max(scores, key=scores.get)
st.subheader(f"✨ 당신의 학교 생활 유형은... **{final_type}** ✨")
st.write(descriptions[final_type])

# 그래프 시각화
fig = px.bar(
    x=list(scores.keys()),
    y=list(scores.values()),
    labels={"x": "학교 생활 유형", "y": "점수"},
    title="학교 생활 유형 점수 분포",
    color_discrete_sequence=["#FFB6C1"]
)

fig.update_layout(
    xaxis_tickangle=-30,
    title_font_size=20,
    xaxis_title_font_size=16,
    yaxis_title_font_size=16,
    bargap=0.4,
    plot_bgcolor="white"
)

st.plotly_chart(fig, use_container_width=True, key="result_graph")
